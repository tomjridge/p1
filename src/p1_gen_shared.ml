gen/p1_gen_shared.ml